check EVERY return to handle frees correctly
